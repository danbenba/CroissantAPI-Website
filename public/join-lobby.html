<!DOCTYPE html>
<html>
<head>
  <title>Join Lobby</title>
</head>
<body>
  <script>
    // Parse query string to get lobbyId
    function queryStringToJSON(qs) {
      qs = qs || location.search.slice(1);
      var pairs = qs.split('&');
      var result = {};
      pairs.forEach(function(p) {
        var pair = p.split('=');
        var key = pair[0];
        var value = decodeURIComponent(pair[1] || '');
        if (result[key]) {
          if (Array.isArray(result[key])) {
            result[key].push(value);
          } else {
            result[key] = [result[key], value];
          }
        } else {
          result[key] = value;
        }
      });
      return result;
    }

    const { lobbyId } = queryStringToJSON();
    if (lobbyId) {
      // Use deeplink instead of websocket
      window.location.href = `croissant-launcher://join-lobby?lobbyId=${encodeURIComponent(lobbyId)}`;
      // window.opener && window.opener.location.reload();
      // location.href = "/close";
    } else {
      document.body.innerText = "No lobbyId found in URL.";
    }

    // setTimeout(() => {
    //   location.href = "/close";
    // }, 2000);
  </script>
</body>
</html>
